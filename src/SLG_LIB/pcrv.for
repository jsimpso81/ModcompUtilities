C-----PCRV.FOR
      SUBROUTINE PCRV(LNTYP)
      LOGICAL COND1,COND2
      INTEGER*4         IGOA,IGOB,IGOC,IGOD,IGOE,IGOF
      COMMON /IOUNIT/LU1,LU2,LU3,LU4,LU5
      COMMON /PLTCOM/
     &NPLOT,MINX,MAXX,NDX,NDY,LTYPE,LWDTH,DEGRAD,
     &NBITS,NBTM1,NBYTE,NBYM1,NCHAR,NCHM1,MSK(7),IBT(16),
     &LDX,LDY,IXT,IYT,NDLTX,NDLTY,MOVY,NCLOCX,
     &LMSK(16),ICH,ICW,IVS,IHS,
     &ISCAN,NSCAN,NWORD,IM(1)
C*****NOTE: INTEGER*2 IM(NWORD) IS TRUE DIMENSION
C           (AS SPECIFIED IN BLOCK COMMON AND MAIN)
C-----THE FOLLOWING LINE IS NOT LEGAL IN MODCOMP FORTRAN, AND HAS BEEN
C-----REPLACED BY THE THREE FOLLOWING LINES
C     IF (LNTYP.GT.0.XOR.MOVY.GT.0) GO TO 110
      COND1=LNTYP.GT.0
      COND2=MOVY.GT.0
      IF (COND1.AND..NOT.COND2.OR..NOT.COND1.AND.COND2) GO TO 110
C-----CW AND +MOVY OR CCW AND -MOVY
      I=NDLTX
      NDLTX=NDLTY
      NDLTY=I
      ASSIGN 500 TO IGOA
      ASSIGN 600 TO IGOB
      ASSIGN 210 TO IGOC
      ASSIGN 250 TO IGOD
      ASSIGN 380 TO IGOE
      ASSIGN 350 TO IGOF
      GO TO 150
C-----CCW AND +MOVY OR CW AND -MOVY
  110 ASSIGN 600 TO IGOA
      ASSIGN 500 TO IGOB
      ASSIGN 250 TO IGOC
      ASSIGN 210 TO IGOD
      ASSIGN 350 TO IGOE
      ASSIGN 380 TO IGOF
      GO TO 150
C-----INITIALIZE DDA ACCUMULATORS
  150 A2=NDLTX
      A2=A2*A2
      A1=A2+A2
      B1=NDLTY
      A2=-A2*(B1+B1-1.)
      B2=B1*B1
      B1=B2+B2
      NRUN=0
      SUM=B2
C-----GENERATE INITIAL MOVES
  200 NRUN=NRUN+1
      I=NBITS-MOD(NRUN,NBITS)
      CALL PDOT(IXT,IYT,LMSK(I))
      GO TO IGOA,(600,500)
  210 IF (SUM+SUM+A2.LT.0.0) GO TO 250
      SUM=SUM+A2
      A2=A2+A1
      GO TO IGOB,(500,600)
  250 B2=B2+B1
      IF (B2+A2.GE.0.0) GO TO 300
      SUM=SUM+B2
      GO TO 200
C-----GENERATE NON-INITIAL MOVES
  300 IGOC=IGOE
      IGOD=IGOF
  310 NRUN=NRUN+1
      I=NBITS-MOD(NRUN,NBITS)
      CALL PDOT(IXT,IYT,LMSK(I))
      IF (A2.GE.0.0) GO TO 999
      GO TO IGOB,(500,600)
  350 SUM=SUM+A2
      IF (SUM+SUM+B2.GE.0.0) GO TO 380
      SUM=SUM+B2
      B2=B2+B1
      GO TO IGOA,(600,500)
  380 A2=A2+A1
      GO TO 310
C-----MOVE ALONG Y
  500 IYT=IYT+MOVY
      GO TO IGOC,(210,250,380,350)
C-----MOVE +X
  600 IXT=IXT+1
      IF (IXT.GE.NSCAN) GO TO 999
      GO TO IGOD,(250,210,350,380)
  999 RETURN
      END
