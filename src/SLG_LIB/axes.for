C-----AXES.FOR
C
C     RX       R4
C     XTEXT(*) I2
C     RY       R4
C     YTEXT(*) I2      
C      
      SUBROUTINE AXES(RX,XTEXT,RY,YTEXT)
C
CJAS  REAL*4    RX, XTEXT, RY, YTEXT
      REAL*4    RX, RY
      INTEGER*2 XTEXT(*), YTEXT(*)
      REAL*4    A1(1), A2(1), A3(1)
      REAL*4    T1(1), A5(1), A6(1)
      REAL*4    Z1(1), Z2(1), Z3(1)
C      
      DIMENSION R(2),D(5),E(5)
C      
      COMMON /PLTCOM/SAME,PREF(2),LDC(2),C(2),RORG(2),CMAT(10,3),LMT(2),
     &XYDOTS(2),SPX,SPY,MIX,NSKP,NBAD,
     &NPLOT,MINX,MAXX,NDX,NDY,LTYPE,LWDTH,DEGRAD,
     &NBITS,NBTM1,NBYTE,NBYM1,NCHAR,NCHM1,MSK(7),IBT(16)
C      
      DATA D/+.07,-.07,-.07,+.07,.0/, E/0.,0.,0.,0.,1./
C      
      R(1)=RX
      R(2)=RY
C-----GET CHARACTER HEIGHT, WIDTH, AND ANNOTATION ANGLE
      CALL MODE(-4,A1,A2,A3)
C-----GET CHARACTER LINE WIDTH, HORIZONTAL SPACING, AND VERTICAL
C-----SPACING
      CALL MODE(-6,T1,A5,A6)
C-----LOOP FOR EACH AXIS
      DO 400 I=1,2
      M=I-1
C-----GET ANGLE OF AXIS
      T2=M*90
C-----GET NUMBER OF CHARACTERS
      NC=R(I)
C-----IF NEGATIVE, SKIP THIS AXIS
C-----IF ZERO, SKIP LABELING
      IF (NC) 400,200,100
C-----SET CHARACTER HEIGHT, WIDTH, AND ANNOTATION ANGLE
  100 CONTINUE
      Z1(1) = 0.15
      Z2(1) = 0.10
      Z3(1) = T2
CJAS  CALL MODE(4,.15,.10,T2)
      CALL MODE(4,Z1,Z2,Z3)
      T2=Z3(1)
C-----CENTER THE AXIS LABELING
      T1=CMAT(7,I)/2.-.075*FLOAT(NC)
      IF (M) 130,110,130
C-----LABEL THE X-AXIS
  110 CONTINUE
CJAS  CALL NOTE(T1,-.45,XTEXT,NC)
      Z2(1) = -0.45
      CALL NOTE(T1,Z2,XTEXT,NC)
      GO TO 200
C-----LABEL THE Y-AXIS
  130 CONTINUE
CJAS  CALL NOTE(-.30,T1,YTEXT,NC)
      Z1(1) = -0.30
      CALL NOTE(Z1,T1,YTEXT,NC)
  200 CONTINUE
C-----DRAW AXIS WITH TICKS
      KAF=10-I
C-----GET UNSCALED Y OR X ORIGIN
      T1=CMAT(KAF,3)
      IF (M) 220,210,220
C-----MOVE PEN TO LEFT END OF X AXIS
  210 CALL DRAW(0.,T1,1,1)
      GO TO 230
C-----MOVE PEN TO BOTTOM OF Y AXIS
  220 CALL DRAW(T1,0.,1,1)
C-----CALCULATE NUMBER OF DIVISIONS FROM UNSCALED WIDTH OR HEIGHT
  230 NDIV=CMAT(7,I)+.75
      L=3
      IF (T1(1)) 250,250,240
  240 L=1
  250 NE=6-L
      DO 290 J=1,NDIV
      IF (M) 280,260,280
C-----DRAW TICK AND ONE INCH OF X AXIS TO RIGHT
C-----DRAW TICK DOWN IF AT EDGE OF PLOT, OTHERWISE UP AND DOWN
  260 CALL DRAW(E(L),D(L),NE,229)
      GO TO 290
C-----DRAW TICK AND ONE INCH OF Y AXIS UPWARD
C-----DRAW TICK TO LEFT IF AT EDGE OF PLOT, OTHERWISE LEFT AND RIGHT
  280 CALL DRAW(D(L),E(L),NE,229)
  290 CONTINUE
C-----ANNOTATE THE AXIS
C-----SET CHARACTER HEIGHT, WIDTH, AND ANNOTATION ANGLE
  300 CALL MODE(4,.1,.067,T2)
      L=7+I
C-----GET UNSDALED X OR Y MINIMUM
      T1=CMAT(L,1)
      T2=-.1
C-----GET 1000 + NUMBER OF DIGITS TO THE RIGHT OF THE DECIMAL
      NC=1000.5+(R(I)-FLOAT(NC))*10.
      DO 370 J=1,NDIV
      IF (M) 340,320,340
C-----ANNOTATE X AXIS
  320 CALL NOTE(T2,-.25,T1,NC)
      GO TO 350
C-----ANNOTATE Y AXIS
  340 CALL NOTE(-.15,T2,T1,NC)
  350 T2=T2+1.0
C-----GET VALUE FOR NEXT TICK
  370 T1=T1+CMAT(L,2)
  400 CONTINUE
C-----RESTORE PREVIOUS CHAR SETTINGS
      CALL MODE(4,A1,A2,A3)
      CALL MODE(6,SAME,A5,A6)
      RETURN
      END
