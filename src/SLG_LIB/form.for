C-----FORM.FOR
C
C-----AVAILABLE USER DOCUMENTATION DOES NOT INCLUDE:
C
C-----1)   THE ABILITY TO SET THE INTEGER DATA DESCRIPTOR
C-----     TO BE USED IN ALL FURTHER CALLS TO DRAW FROM FORM.
C-----     THIS IS DONE BY SETTING KX NEGATIVE AND PASSING IDS AS KY.
C-----     NO FORM IS GENERATED BY THIS INITIALIZATION CALL.
C
C-----2)   THE ABILITY TO USE EVERY NTH ENTRY FROM ARRAY XD OR YD
C-----     BY SETTING KX OR KY TO 1000*N+M, WHERE M IS THE NUMBER
C-----     OF VALUES TO BE USED FROM XD OR YD.
C
      SUBROUTINE FORM(KX,XD,KY,YD)
      DIMENSION XD(*),YD(*)
      DIMENSION X(2),Y(2)
      DATA IDS/0/
C-----EXTRACT SINGLE/ARRAY INDICATORS AND INTERVAL COUNT
      JX=KX/1000
      JY=KY/1000
      MX=MOD(KX,1000)
      MY=MOD(KY,1000)
C-----SET X ORDINATES FOR HORIZONTAL LINES
      X(1)=0.0
      X(2)=XD(1)*FLOAT(MX)
C-----CHECK FOR 'XD' SINGLE VALUE OR ARRAY
      IF (JX) 10,150,100
C-----RESET DATA DESCRIPTORS
   10 IDS=KY
      RETURN
C-----'XD' ARRAY, RECOMPUTE RIGHT X ORDINATE
  100 X(2)=0.0
      DO 120 I=1,MX
  120 X(2)=X(2)+XD(I)
C-----GENERATE HORIZONTAL LINES
  150 J=1
      Y(1)=0.0
      Y(2)=0.0
      CALL DRAW(X,Y,2,IDS)
      DO 200 I=1,MY
      Y(1)=Y(1)+YD(J)
      Y(2)=Y(1)
      CALL DRAW(X,Y,2,IDS)
  200 J=J+JY
C-----GENERATE VERTICAL LINES
      J=1
      Y(1)=0.0
      X(2)=0.0
      CALL DRAW(X,Y,2,IDS)
      DO 250 I=1,MX
      X(1)=X(1)+XD(J)
      X(2)=X(1)
      CALL DRAW(X,Y,2,IDS)
  250 J=J+JX
  999 RETURN
      END
